GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


      Bismark Singh
      March 17, 2021
       
      Code for plain Lagrangian decomposition (removed Progressive Hedging)
      Based on the paper at http://www.optimization-online.org/DB_HTML/2019/05/7222.html
       
       
      Excel file used for LB heuristic needs to be manually sorted
       
  12   
  14  OPTIONS PROFILE =3, RESLIM   = 4200, LIMROW   = 5, LP = CPLEX, MIP = gurobi, RMIP=Gurobi, NLP = CONOPT, MINLP = DICOPT, MIQCP = CPLEX,SOLPRINT = OFF, decimals = 8, optcr=0.01, optca=0.01, threads =8, integer4=0;
  15   
  16  ********************************************************************************
  17  *                                Include input files
  18  ********************************************************************************
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/inputME.gms
  20  ** sets later to be defined in input file
  21   
  22  ** to be changed
  23   
  24  SETS T times/t1*t24/;
  25  * Number of scenarios
  26  *SETS SCEN scenarios /scen1*%MAXSCEN%/;
  27  SETS SCEN scenarios /scen1*scen100/;
  28  alias(scen, w);
  29  Parameter last_z(scen);
  30   
  31  SCALAR G, GG, start_cost, ramp, uptime, downtime;
  32  G=130;
  33  GG=20;
  34  ramp=50;
  35  UPTIME =3;
  36  DOWNTIME=3;
  37   
  38  TABLE wind(scen,t)
  40  *$INCLUDE %SOLAR%.csv
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/wind_scenarios_100_13.csv
  42  ,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15,t16,t17,t18,t19,t20,t21,t22,t23,t24
  43  scen1,38.96974909,45.5184343,41.93152872,1.850043245,2.426887238,10.46329475,9.65056914,33.16861188,27.10294938,12.741329,16.63723498,23.64583003,3.70864038,11.20899345,8.741396222,42.52769904,43.80579316,38.11204261,23.11068866,19.06523102,6.641419
      818,33.23490664,20.7275087,14.13241657
  44  scen2,34.708283,37.77462928,32.66378969,7.284216227,20.68768471,12.31240205,2.319708531,4.123505851,18.0002808,13.97707367,18.05216356,22.43376529,14.87953741,0.014529824,9.48905385,30.10198509,18.15137128,10.38632927,34.95642456,35.71519075,41.7841
      3645,21.29654678,11.60099941,26.81284468
  45  scen3,43.89969363,31.650278,37.70128352,11.3976056,21.13403469,28.34861659,13.03787317,3.520350663,1.033717059,15.58192397,24.35826932,27.61756687,22.44626923,36.15311818,29.7046429,36.11257693,47.67981656,59.77541471,20.39556595,2.65443703,3.932306
      382,30.07225272,34.46560201,37.92524611
  46  scen4,43.92292811,49.31084856,49.17694849,0.402625029,7.685765064,0.846294009,8.112483443,7.251788769,14.81721555,9.079795904,22.27857961,12.15457996,6.4379001,1.18917146,2.217739261,38.45966638,46.71930316,40.33985935,39.32116229,29.75543652,25.720
      62016,24.4489279,23.57882462,29.1687145
  47  scen5,58.69952784,65.74828317,57.93199957,11.05350888,23.63739989,26.08176634,36.95792634,66.83316512,72.79642618,29.21654625,26.54297371,22.44385141,25.52571575,32.74236917,21.47119046,9.56661229,7.20809181,30.88691643,29.22292436,25.27698231,19.57
      458215,21.99487882,28.16480168,42.90568863
  48  scen6,26.36215152,12.26183755,19.40751406,0.848318978,3.531852903,1.91925688,3.546547173,3.690415287,4.209905533,7.012315627,5.15804175,4.81803019,20.95854301,34.13761082,27.09096709,27.52436103,25.96132906,34.94384284,38.30170695,37.75246112,36.000
      15084,30.67686836,43.03503836,38.40068249
  49  scen7,32.187096,29.81592645,25.10444535,4.959363544,7.94230187,4.396876085,7.839530773,23.82709548,27.8624674,2.58161654,3.095834853,23.01229299,9.395522886,12.016686,0.357261732,29.64894478,43.25839123,39.5373376,21.64371211,9.765486942,22.37438107
      ,29.06155849,20.97937786,17.89151931
  50  scen8,27.11806941,40.22464192,57.68737532,6.417737843,5.958823417,21.52654391,10.60164497,1.549315709,7.376269056,0.952929338,9.411815431,4.482065193,23.84634137,29.43693233,20.82836429,22.36444169,26.07118975,24.1918229,38.90289023,28.62649915,8.34
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


      141302,7.043898444,4.988572666,4.126570353
  51  scen9,33.46944299,27.19934357,20.28223517,9.958699392,14.84680124,12.18528919,3.145556202,8.844716336,36.20380189,8.76129749,9.198743397,1.613583389,10.86486625,4.553976631,8.252033903,11.79102568,8.188253115,15.09851221,28.61609438,34.16274445,26.0
      0554994,22.93540907,27.26443581,20.89706593
  52  scen10,34.09872986,19.62478647,11.69226509,26.22728612,27.21792753,9.155107026,20.70182977,7.761259471,14.41371024,4.08606354,8.4209233,25.50644493,1.433398844,1.075291885,0.807598595,41.6598996,44.10459862,50.34163512,30.59567545,31.80498708,27.505
      94058,15.7456945,13.33855829,16.81906414
  53  scen11,34.72058695,34.98791477,28.9571733,9.174517381,3.362039014,18.62347105,17.44258462,17.53980177,15.6261847,11.77461865,10.99196362,31.12735864,19.44964306,12.29365532,16.95345103,27.52632728,41.38722923,55.48912144,28.6602642,41.64105553,49.38
      467895,27.3194116,28.02738081,17.0160538
  54  scen12,34.45325292,27.68965845,30.16265156,11.99443424,9.635393488,5.59673273,25.20950263,32.07280742,13.50666831,0.7209767,7.64375245,9.946182645,30.18845714,26.75453526,35.07058975,44.88867395,51.32180122,54.1828129,37.8274432,44.1656865,34.460766
      75,19.25664761,9.965534776,14.58674548
  55  scen13,34.05018655,29.18179732,41.22321112,8.623989582,14.65232854,7.179991425,16.89419558,25.65517746,29.9584157,11.30834209,21.3988694,9.739874022,0.958199235,3.040499126,2.124665643,24.17765955,25.16565717,16.41492167,48.82729104,40.25331485,31.7
      7283721,26.09395079,17.26250308,37.94238793
  56  scen14,36.70668262,39.72961059,43.56664122,9.462840705,19.97050856,27.17207337,24.30317498,29.23990236,22.17096082,16.50458941,0.579695499,10.44354804,1.250660195,0.392434893,10.71400459,42.75930507,49.57528983,50.34482396,40.01343101,19.8208247,22.
      48541504,38.41845458,45.08535818,43.44610329
  57  scen15,43.17515276,42.69203206,49.17673583,30.22226364,36.21696312,28.40375429,0.808983004,9.502215441,16.43256865,3.076411883,7.918565618,13.27293227,19.55158111,38.69069716,49.13421252,40.33200999,40.28137027,24.41667905,31.58817108,32.99599571,21
      .25300066,42.7754567,60.94930732,58.27674847
  58  scen16,49.8391098,47.22596719,57.29844518,0.369293588,4.431239201,3.545913265,13.24146091,3.563305661,12.79115407,13.6292667,11.72014511,1.764534316,8.252314343,13.70730114,38.89800883,38.93645083,30.02796106,33.47282354,24.03418998,20.69547122,31.2
      0989106,33.99478891,32.25559602,47.54180804
  59  scen17,35.46399459,24.27445635,21.22459856,5.681260638,10.62129506,16.63445137,2.286521272,4.292503498,0.684832772,14.34167874,21.37661111,18.60526459,4.773545528,1.083304234,9.791954662,23.40228462,25.22867303,32.12597894,32.11894737,37.64764263,41
      .75323496,10.69522934,19.44377127,13.82101773
  60  scen18,56.77763386,50.98674505,56.77106773,0.676356713,8.09575218,1.986687518,12.96517166,5.173530755,10.62268446,8.428090285,11.82887507,12.79313293,20.50420462,29.49209274,16.38820403,31.75982016,15.55177616,14.51182859,21.60335418,28.97690804,36.
      81051326,40.49520188,56.46008575,53.95625674
  61  scen19,47.49664493,38.27413988,34.16865988,14.16765877,13.07840897,5.300637427,9.566399727,5.520014336,1.5202224,27.86415133,29.56711788,24.85682974,6.987295904,20.27530921,26.80017412,28.92476249,21.29525248,11.50538403,30.45261251,28.38261448,28.0
      192396,36.68307732,49.15581133,49.89059526
  62  scen20,50.8691983,46.24265003,64.09043334,9.706789643,26.04674965,22.50266403,4.887765863,3.50338798,9.561347117,3.523681558,3.80010359,0.946209073,0.754438245,7.005901046,16.7660742,24.16165453,32.81833449,47.51408104,40.46037834,43.35253281,33.049
      68698,28.69543847,44.23589876,52.60188662
  63  scen21,29.48282365,44.50051211,50.03551059,4.044396046,1.925291854,4.363854004,10.87196095,24.73486691,23.57424608,11.51832892,19.64031628,15.04997369,2.83131462,4.384875635,15.84220461,29.16696053,21.57125065,30.36226806,30.45123914,23.31435046,6.7
      51149785,49.85981591,57.46548638,45.63375499
  64  scen22,21.23898667,19.28398994,15.28385838,14.44043775,26.22607491,24.43138939,15.1972959,20.28774455,10.99498322,0.165257017,7.27266374,8.422307598,3.647045076,0.499648242,9.904452315,17.73284947,17.72224838,12.50988364,42.89762762,56.40413428,58.6
      7014532,21.75038285,5.766414764,5.31229121
  65  scen23,42.19043828,36.74531227,36.03696473,2.551180555,7.250609264,19.04667231,21.32312856,27.50607316,23.38791528,1.827510715,4.768414201,1.762261942,17.59851645,26.65507958,23.62293616,31.96320946,29.46572893,16.1547994,26.45884888,26.21300773,33.
      70201808,43.66917172,38.80758452,39.28850688
  66  scen24,42.35943974,41.03840084,32.85577484,8.386894355,11.04077907,7.855714773,1.519714203,6.315322001,1.820515467,13.13122758,2.692285251,19.65790927,2.750421245,19.05785699,18.64666433,31.57372227,33.80527076,44.01586778,35.55554361,31.05433569,36
      .90052936,15.47459416,12.69689154,11.98995561
  67  scen25,22.48263241,21.67223665,8.192395588,9.174553447,10.57836112,18.78881,4.651766298,8.155331111,11.28712557,19.46897613,18.85421396,0.241440987,13.04679661,15.98922861,20.66630753,25.41107486,28.09684813,35.24931886,34.51044532,30.57577207,28.75
      558164,22.36984748,8.060796152,9.712539509
  68  scen26,24.56684317,24.38223082,28.975579,22.52636855,35.32471099,40.32588222,3.204497628,6.930224006,7.609630762,10.49791455,22.46610953,15.14601801,18.24970564,30.77232781,35.08740966,39.68928513,35.62650499,34.49112547,17.69017101,33.24129532,53.2
      9532282,14.83242842,8.360447565,7.768566339
  69  scen27,42.43462425,45.46689736,47.34708902,12.46227981,2.329696391,1.926940395,18.45329518,12.33042687,11.95497218,21.52953228,28.64452821,30.4285367,0.126068903,1.579721975,20.24251317,23.29922748,0.881378159,0.909341545,26.22832052,30.38011312,33.
      42805574,31.70114296,45.36309495,30.34427618
  70  scen28,49.08801164,60.66716667,67.20711835,7.547332396,9.847040267,21.11659885,25.49887944,18.02022499,19.54655204,0.198185893,4.006732329,9.060091723,11.73595435,19.67472395,6.333642872,31.08059192,40.46475646,48.86930521,41.07134046,46.70023599,42
      .53465325,29.76972507,23.14910564,22.20589576
  71  scen29,52.19793097,50.31987709,39.81471247,5.81806683,5.270407939,18.60797591,20.47369851,4.956873309,6.609902706,12.13168777,10.13789899,3.703835886,7.589296117,6.612760076,5.122168619,38.59636895,33.80807787,28.145178,20.24067163,21.79068499,24.35
      210205,19.90068411,21.29302982,26.96858599
  72  scen30,30.08495988,31.53420953,24.51363077,7.073738591,3.841047517,14.0636888,23.24721658,35.46115429,42.35985223,3.68306267,2.777104133,10.93907056,15.259978,23.83124828,37.31150166,35.56623316,38.49537357,53.69414753,29.81204473,34.00453789,28.854
      45021,12.55350854,13.55479011,22.10452519
  73  scen31,44.88992617,39.19484808,32.38562537,12.96783874,7.187368049,8.320013996,12.63371102,4.858309954,16.88274991,1.481468615,22.311689,38.82005471,2.424571017,7.111645532,10.92671593,10.1868676,15.7926169,22.63045624,21.8305517,24.9455095,33.22819
      382,0.006327985,14.24406896,9.521809241
  74  scen32,44.98346962,27.24495361,13.52973329,0.418982987,12.43654377,7.040967366,2.416432773,3.332718173,12.31764409,16.73889102,19.9808608,17.8622618,16.32435038,35.62254551,43.94580063,25.98415301,14.11898119,5.555352437,21.77949509,20.35733829,36.3
      8466404,16.96082175,13.47065036,5.231046104
  75  scen33,38.70017309,32.48811353,57.25404532,4.881154336,19.21472107,33.37475093,16.81861658,20.34729517,6.218657716,16.23446047,18.86307084,52.11355851,12.70013406,19.03819827,20.06709523,29.54534675,40.97346467,38.30264151,22.34382854,37.58768801,51
      .1402706,12.28559963,16.78429972,25.18622027
  76  scen34,28.78607088,40.36437632,46.52265379,1.226245488,4.66872769,11.50321119,26.99361312,32.19689927,25.24234351,27.0708811,29.06147062,25.06866998,4.485674289,7.050545869,0.736997176,28.11415936,34.31114023,50.41033211,39.3041377,38.2408486,39.562
      70873,32.65842653,22.10760551,19.20035969
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


  77  scen35,28.27465138,22.54040905,16.0816212,8.991411293,21.66960118,13.14967007,15.13007814,11.38155129,3.20657425,13.7015649,16.93388999,27.80454923,5.901606507,17.91127785,15.74953449,20.34027324,19.3024057,14.228041,31.36569253,23.18539758,8.672841
      765,36.7059825,30.23344032,28.14049656
  78  scen36,46.21106288,56.67151937,61.13823603,9.441297113,7.390411087,12.93367739,19.24381606,20.14436734,17.22663498,22.22437088,23.00947459,22.33081386,21.43039307,23.40424038,39.81414182,33.07418241,29.3556856,18.38581161,34.93905947,31.50618779,24.
      36178295,6.767262574,7.301112131,6.018518111
  79  scen37,22.65951815,25.34255217,39.16040023,24.1874953,51.89997668,44.74035185,4.795014106,8.447835289,12.51272526,9.417618488,1.148801064,15.61401955,9.969688075,2.029878805,6.574109978,31.86369462,43.15987376,56.22137626,25.90445195,36.56764076,42.
      79400921,9.244097353,12.08937983,11.79983168
  80  scen38,36.14478592,29.28585035,34.67088925,24.89867526,23.36035339,35.69418432,15.76195096,31.43699472,26.35331425,3.117485497,1.59147529,23.36749364,24.79129017,26.36442507,32.20355912,45.93310833,52.05314566,54.54206324,30.09017677,37.50712512,38.
      07392765,21.57543085,16.66688595,35.24218363
  81  scen39,40.37764818,58.589831,69.73793408,17.5467579,8.338901348,2.527875469,8.713965153,1.076455902,17.41622094,0.362360722,14.82199877,9.107403678,8.56843035,1.546502418,12.6528603,34.58429918,39.76585604,61.74759084,39.4386452,52.11751071,66.60502
      751,35.44128841,39.96853719,38.4249102
  82  scen40,49.63746459,59.19214418,63.6662592,17.76406104,19.92178534,46.56128869,15.58961174,16.1157548,13.62112266,1.040988863,3.407161045,6.773103359,8.803686641,10.31577305,16.10838336,40.35179128,67.44201683,68.16166024,18.78546782,14.7498297,22.00
      63728,38.41476317,34.19742121,37.39739492
  83  scen41,35.52046063,43.14442051,29.63431032,4.145221832,2.978935955,3.79512019,22.62279938,36.62100555,37.175321,19.56115331,15.80036893,34.00510179,24.9154101,30.79326329,19.14697156,32.22566918,37.25412069,44.26754858,23.92786872,24.24802062,11.226
      29628,40.52703443,48.76369543,27.59657959
  84  scen42,25.47471917,13.90544923,5.819665008,19.62855889,30.12862822,41.55882103,3.994194054,8.797039196,14.34456432,4.174322211,5.783259584,14.19713176,5.652382296,2.318797126,10.43060469,15.74680559,24.23648601,27.32076005,41.22356892,25.15086703,27
      .63521396,22.3780282,15.35762959,0.56060483
  85  scen43,42.39552667,36.03256152,44.48344394,1.927715783,0.26534264,1.109559156,24.85052253,18.25172322,0.042007362,9.733201544,21.58443786,28.3155387,17.47186467,36.57706726,30.7549096,19.17062767,16.26684568,21.55598334,47.77451004,59.56009694,65.99
      708522,19.83850598,21.69084373,15.44112736
  86  scen44,32.01570298,36.59994074,35.7475121,8.323379835,16.2644495,16.9494936,1.038993304,8.995622945,1.499480721,4.116181587,12.97903388,17.1251579,1.463791565,15.49180534,11.15465614,26.18845285,42.39906212,30.2115313,22.91024923,20.55849489,38.1938
      2046,16.18177737,18.4435999,21.71051775
  87  scen45,56.29204973,70.06279192,72.26932274,38.00715245,29.94975297,18.95280251,10.60729318,13.91248679,11.95007828,7.064536747,5.083107414,3.028026492,14.43320902,30.93282548,29.92123124,29.27677035,27.52622879,30.04398112,35.57240395,36.79627749,37
      .32746612,31.58755257,46.76950162,52.35734537
  88  scen46,30.57416259,28.39135935,33.96600374,10.32390168,7.027440194,9.18040926,13.19445867,10.55797284,14.49938403,6.96188745,6.539723389,15.11217605,16.60263441,25.43989854,11.29357757,39.09643037,30.13748533,35.37269761,19.18014922,27.1411784,32.36
      559704,33.66671272,24.45904454,46.86291193
  89  scen47,40.67444797,56.97504041,48.94750553,0.781084973,11.56626068,25.70136488,20.5816289,39.13360745,30.83466676,2.015510755,1.474945691,4.339119789,18.33403849,29.28290229,26.31656506,25.38104758,23.78222152,24.29474944,37.69581976,36.0503,19.7390
      6123,11.35605255,11.51307763,3.499336017
  90  scen48,58.86765666,60.13634428,59.41046734,7.302980385,16.27089547,10.87174645,7.068823864,13.10626789,26.64867443,16.22775377,24.47296227,24.1216751,13.3367456,9.529436726,2.224775784,27.38041111,9.574136845,3.870832132,32.5960915,36.99687456,33.06
      819552,24.87225247,8.287484799,10.64110095
  91  scen49,49.25969056,57.24459673,52.61600719,7.896813423,8.915891513,0.070333568,1.112094597,9.065186875,12.0097262,25.46489495,31.50654176,27.45858315,8.088413634,11.1289306,5.32662035,35.9806468,48.43193603,50.22108849,21.44615042,12.9310552,1.76921
      4224,21.06640914,21.90131099,20.21492141
  92  scen50,38.84754823,38.25150087,23.38530044,12.89817374,32.14736118,29.71862414,23.98217721,26.92272951,28.44378534,13.56352319,10.37401253,6.687564138,9.889726448,1.019547801,2.224370118,28.02929064,15.49564763,6.270547571,36.2498677,31.8648453,29.1
      6948003,32.08557874,41.04046289,33.62550742
  93  scen51,43.67027858,54.43289652,58.94067568,0.26959569,4.65406578,22.3563559,13.73583144,12.27670797,13.98604889,9.789547854,5.838281161,8.706970077,11.42445761,16.03843942,29.20227687,21.55106773,22.25141524,35.69934852,43.59491361,50.79807817,42.92
      537691,37.35209802,29.13337718,16.76707753
  94  scen52,62.3706601,62.25141009,50.84579,12.37178942,6.132803731,26.99711718,8.393777323,2.86183635,3.887727736,19.27810712,10.90349745,15.76055915,1.306092192,13.10509049,17.13609441,28.10714794,35.98666333,41.05015884,29.7696872,27.47991943,14.78411
      696,37.89284692,38.13937491,46.39822969
  95  scen53,52.62857885,53.85605275,47.11376557,7.571438255,22.67482378,9.402394572,13.32051736,38.01824864,25.01280379,15.92178608,12.92936173,13.86250822,13.836189,5.794466611,9.39410716,26.87993804,30.37109781,36.91574999,22.56568486,5.984127217,4.364
      522347,30.97081726,44.0702592,41.73938345
  96  scen54,26.09774745,8.806015423,5.881835114,8.94016489,9.046856759,2.342426879,6.322179067,9.840079671,8.452286472,14.96284889,19.56473076,23.53995815,1.863291095,3.695700292,14.02683473,40.21260834,44.73324016,50.89863304,20.43338486,13.50918202,5.5
      23152615,22.16097012,38.03152669,45.8641463
  97  scen55,40.80772466,43.42478678,37.30375845,2.447807999,5.84824237,2.046482813,17.89935498,34.75977853,22.58084845,8.572764137,1.918561263,23.02152435,10.038265,25.37486363,17.57635053,35.65094908,27.42047321,28.54081633,19.22870535,45.62975266,63.50
      857104,21.58799594,21.29159451,24.07839801
  98  scen56,49.36415094,51.25714024,54.16079612,5.767028927,0.195120437,10.00666349,23.69589842,22.25229517,20.14079706,0.742633794,4.515443054,11.48095869,10.10445821,18.07376702,21.78391209,38.80069858,38.9331786,51.99880028,35.17551464,40.58345059,62.
      64142728,14.81511605,27.88124962,16.01376327
  99  scen57,24.09071688,26.28149204,43.18004079,8.016612691,15.14649714,18.64504459,8.43343779,5.658028616,8.731816408,0.35130958,4.428869678,4.214365006,10.40744444,24.4959178,38.43051391,29.02384121,37.20317586,28.00286558,34.60133254,37.21923139,38.73
      677235,37.55098956,38.19685024,44.73988301
 100  scen58,41.81835782,44.94337108,33.64558046,9.094565354,9.10195752,10.32223303,1.379253384,8.004726607,13.28326672,6.712661355,1.446330601,6.685735424,10.63108594,23.9051784,48.80617297,54.07129686,49.71067498,45.77821622,23.68420193,18.52248416,21.3
      5129657,17.49807348,8.044204253,5.40158325
 101  scen59,38.34933248,31.13537111,32.97767775,9.708217271,14.12032374,16.48754042,22.13813193,16.92368292,2.526181437,2.250482086,5.26126351,8.483171884,25.72014255,20.27333471,13.77701978,34.55399081,22.54258515,30.94885775,38.63227544,22.1031836,0.37
      4178274,7.300217272,3.733545706,0.743558319
 102  scen60,41.8154615,48.10771141,53.39571894,22.09083937,23.22990147,30.61580464,5.245459482,15.31154998,22.31885574,0.208347015,0.989029439,6.209565513,20.47082328,17.27890717,25.02095814,24.5511108,16.19172054,15.65488751,20.94263032,20.64547523,36.3
      6964452,18.1916732,0.401717845,2.626597072
 103  scen61,31.18532457,54.72988663,69.02261252,8.258013231,2.510449271,7.432685887,2.253438391,13.67434797,25.7270508,19.54020703,17.07496685,4.235289095,26.60431824,30.27420037,22.21711965,20.62570084,26.74944373,35.33302236,45.76149958,18.10598439,6.0
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


      27011025,40.33826436,34.93010563,36.57754578
 104  scen62,21.25067548,11.62597548,23.97256951,11.491696,9.63110974,13.45797369,2.056158216,25.82939153,24.39621036,2.914260434,11.95601879,10.46740711,10.62733665,8.943342362,2.316404939,34.45238677,31.76884287,15.36264807,10.61678552,1.594875523,2.706
      319434,28.6895416,23.44767748,33.39595711
 105  scen63,28.58617556,35.41139928,26.48459986,20.28844498,25.86910131,10.16009036,4.057628393,6.156057049,2.327071493,3.560760477,12.11931645,38.12882171,17.31860516,15.39659778,8.871820109,29.54012893,30.92207283,34.86382783,28.64032803,14.08601145,10
      .16350767,22.66610027,35.91946906,39.72046194
 106  scen64,57.23905449,53.87788951,51.36399938,10.9235373,23.61505161,22.91642683,12.89137199,18.19341637,35.53824124,4.797433916,10.57853948,6.225530904,2.738009688,20.88472587,23.2460649,20.35071567,1.162066851,10.09003991,38.62528657,37.70960628,40.0
      6015824,28.21771456,31.10477566,14.87415436
 107  scen65,37.75076315,28.11856432,38.25862875,12.95260785,13.91845472,24.48362496,6.985217809,20.56272072,4.416946133,2.185213143,5.921213368,16.81871081,6.239656676,13.89832065,2.319263208,28.92596155,20.53364977,2.154103367,31.42120302,41.88656767,42
      .68125451,30.00787332,50.8845403,62.14462413
 108  scen66,29.76154169,16.79215672,20.67426128,2.607769317,9.425180389,4.471432908,17.875716,21.9255848,31.01615903,11.39286576,15.87354229,17.81582707,8.506051036,11.6285753,24.28936093,17.66638219,8.219304793,6.164321621,31.7789118,36.87892594,38.9008
      893,30.48916939,35.89631329,31.2504501
 109  scen67,53.28202476,60.5106278,73.13190006,5.425583394,1.275314027,6.101184582,9.659182237,20.53565729,22.01563119,6.595750548,18.08844746,11.85735318,9.164048198,17.83243249,19.9491131,40.12756868,28.6963924,13.82218876,26.35821028,21.27900725,10.72
      089555,24.47895988,28.05398029,47.07188498
 110  scen68,47.9460572,49.06744563,59.56854618,3.902602481,2.04727201,12.13647465,8.171841649,11.87505972,13.24750925,5.597453937,9.286533809,7.206558568,17.49695325,23.30327499,30.39381958,52.38940872,66.60119431,56.48832612,50.40742776,37.60054266,34.6
      639083,48.43997246,50.15996306,54.08834783
 111  scen69,30.62615087,37.20176076,61.53481744,6.044687379,2.103493517,5.219317271,6.52515477,0.859773691,2.20322701,14.48593349,12.18416722,16.47010943,1.802060462,30.55056444,24.83434263,40.68968264,51.7631027,58.29921703,26.82664924,20.95080527,6.088
      164655,36.51937979,29.87758906,34.31175178
 112  scen70,49.46230619,48.65106286,21.37521554,1.853565471,14.06382189,13.69434226,2.671547818,6.244575902,3.2021834,5.306020868,11.71447159,3.390824147,6.322245067,4.875046763,10.54266231,30.35152603,14.45810925,22.80461463,38.08756758,27.63533776,24.1
      5739986,2.151576975,0.434457805,0.031021462
 113  scen71,49.80688759,39.47046577,32.9054199,0.828759006,6.315363235,6.680547284,11.22557043,12.32627657,11.15283658,3.010945853,0.90934235,14.27591025,1.445892578,9.805215401,11.57911461,46.71135427,51.04883312,48.02752206,43.07728949,49.1086898,50.46
      53663,16.98228658,12.28692728,4.74461539
 114  scen72,31.48977458,27.77875516,24.32021656,21.29560451,38.79982005,25.78138953,6.048061565,1.26804123,3.725905458,0.563361678,9.727396919,25.13358583,0.626095798,11.37553626,20.52040385,36.32263973,27.21488127,20.28343437,27.99884767,21.79692188,18.
      50908645,25.91572993,11.13907105,2.077140404
 115  scen73,44.26057509,43.76361474,28.77388412,6.087936081,7.424772799,0.377264246,22.60590879,23.93034128,18.74461334,16.56213723,5.334129849,3.096854225,17.25792283,17.37120451,41.99287242,11.9210394,6.761669675,25.85996968,45.38510371,61.37627754,65.
      41768415,31.06499479,37.24105064,25.35614941
 116  scen74,35.4077874,40.19307432,35.83554019,13.34993715,15.65511135,14.89429659,7.594196764,13.62493261,26.30416331,7.785252616,22.30641477,32.04890173,9.139110875,16.12323666,37.75135962,32.0873271,32.14616165,31.3560568,35.61741509,35.16246211,43.19
      92206,23.46334818,21.8371632,14.21165698
 117  scen75,51.17185521,40.70856288,51.01724471,10.87453517,16.41389471,19.02194561,8.448797383,3.793915453,0.55694373,6.251683902,13.92932742,23.85287285,15.67523485,20.93775905,21.73942884,34.25843853,50.83341697,56.91822453,16.83796559,0.18702745,16.6
      6178965,25.78572046,28.67480866,40.98478025
 118  scen76,26.74262669,6.297104777,4.635383687,2.640458418,11.81418018,14.83780594,11.32420586,13.51544335,25.71559958,29.94794801,37.36964849,43.0045383,12.3424767,23.73087913,40.2093763,38.9590344,43.25278541,39.7814076,26.72028878,26.78134724,13.1831
      2226,23.07288539,17.93033773,11.99025199
 119  scen77,35.04037062,38.27519013,48.12304211,11.14662469,35.34301569,41.76451994,3.187829121,0.651042002,5.885868091,5.522378402,2.245602896,2.240415548,17.58260713,39.92019119,37.72188807,31.89631062,25.09930189,29.0255624,29.8901377,36.65203946,31.8
      5883716,13.43434443,18.50241898,20.52324093
 120  scen78,46.99143513,40.09060156,53.51243259,6.712560439,23.27621405,9.867484351,11.2991945,16.84247923,17.45309121,11.47936237,20.62250891,38.75626868,13.45859797,23.93955058,18.2262347,44.90368251,54.61093564,42.79715463,37.50353915,33.6641507,36.50
      970263,46.9364087,44.77686409,57.48173878
 121  scen79,38.23879657,32.74341533,28.68916686,9.908531375,24.56549099,26.12867767,26.36061329,48.00565695,39.73892245,12.2937385,0.847108984,9.285001235,1.451563954,19.22614556,26.42150306,20.57914272,26.90518074,29.48524863,38.2305635,45.33198602,49.0
      0669982,24.32496267,27.89672635,24.14531956
 122  scen80,44.61549223,50.24197056,46.02909434,4.297686629,24.16801436,21.54983065,0.001177391,8.950778737,15.89067136,3.857363599,14.43252554,6.312654885,6.814158435,10.45831905,20.03599408,57.40097191,62.33041715,51.58271684,38.07848736,42.44921605,38
      .8980614,48.83112361,59.28344427,56.64687936
 123  scen81,55.90381433,58.12830187,43.24472397,14.60955389,15.6981251,9.100978801,6.799191941,1.562194086,0.556014546,20.71575914,40.23985528,43.48378725,11.86744568,6.451260138,5.212326951,46.6390143,70.33421357,70.53074391,17.23464386,18.77516671,26.3
      0183881,17.57719702,15.41321847,23.11736369
 124  scen82,34.8670814,35.21736044,32.59873051,3.532208657,18.03549848,21.47277945,3.585471977,18.00345787,15.21809557,11.28550838,3.978766393,8.248776816,19.64982987,15.34430213,20.82854014,31.09429847,28.93206815,35.44977756,16.46903185,10.97741239,32.
      05988824,23.73133643,14.80366098,15.94791398
 125  scen83,28.35876686,37.59835904,32.8796897,5.629047207,15.37398837,30.66405655,17.2870999,28.32517587,39.02087069,10.24078186,5.463354231,20.01248209,2.266961405,4.257912768,8.324717526,36.2933427,32.10506875,50.04423102,44.38247112,45.20238028,33.32
      447346,13.50749539,14.24383243,20.65315124
 126  scen84,54.19999578,66.34141299,63.88437699,8.162430056,12.07475739,9.919165006,1.514507259,11.31413528,14.99043529,21.97468924,26.43262237,37.69425315,2.60407244,4.844803159,10.46827176,25.0095058,28.82411191,25.89007128,39.30713406,39.26666039,30.1
      0972513,17.91371409,27.49323141,26.60076969
 127  scen85,34.75974504,33.52477683,31.17276589,17.9299371,17.10152888,25.66538208,1.867272085,4.710481447,8.172417644,10.39089938,4.661511611,3.562816852,5.712984374,11.09423291,3.652276763,24.44485639,10.20045944,14.0785823,35.30898567,34.69773162,16.3
      5168395,35.00090147,15.61407495,10.14711383
 128  scen86,42.10624554,36.81982053,28.08890356,9.806238254,7.493099218,10.49936964,24.04380463,32.42165321,30.89104017,7.899230541,7.306209645,12.79155085,15.24385813,26.16503138,24.65549593,34.23369999,30.18439546,24.89394574,46.33339465,34.54805164,32
      .25502833,33.57888789,36.2514903,51.87768756
 129  scen87,33.35435586,20.25844733,7.274719649,5.41813345,4.565892629,0.633700936,18.21535071,6.354392839,6.914999784,8.688103406,21.8883397,16.45244508,9.519885781,15.01874076,2.140055766,43.07563487,39.16331326,38.17745179,49.25726996,51.90506572,57.9
      6294038,17.72056001,18.16977225,39.19836502
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 130  scen88,23.76070483,23.83551669,21.49125067,3.133759964,12.17768254,7.595332869,2.861059057,18.52201064,42.92294262,20.18934006,24.42916198,35.5903686,19.42884817,13.00657117,4.981390642,42.49405709,57.02532354,85.18160477,23.79387244,11.05263806,6.3
      24292143,27.69918528,31.74344659,32.1874187
 131  scen89,29.80232897,50.24187442,54.20182297,19.55417505,21.75001038,23.85002135,20.09282429,24.32663497,16.64005177,20.63303085,41.05610853,42.93620027,0.980706726,5.084466352,13.19970902,54.2150516,64.17199086,64.95721188,31.70923419,33.02628724,43.
      78959814,21.9502311,18.00936251,10.67939266
 132  scen90,51.76912048,63.34625351,54.50824391,16.1145076,39.23587052,42.28978743,3.802836007,2.20645417,17.01502771,11.41732028,0.480227747,5.59997449,12.48206348,7.552557241,4.305978007,30.32570782,35.5707718,30.83321116,35.49255847,24.81934111,20.413
      2706,34.27769078,39.23925589,38.51194323
 133  scen91,34.97612641,35.92712718,39.51014617,3.049003732,1.01293643,6.150541892,11.24110296,20.94044286,21.53361345,7.619135868,11.17561862,7.644529583,12.24927644,8.920736569,10.99661771,31.3252833,39.76265763,50.95592643,32.47201985,45.913188,50.261
      28937,18.75249011,12.60479962,7.212807134
 134  scen92,37.55197116,26.04668985,22.55059536,5.863250783,12.95412634,18.79671525,28.043425,40.36231357,50.23280265,19.50346508,14.47086312,23.87872686,7.4973152,4.729986199,7.20003836,6.911406057,11.32125833,23.97370755,33.27347237,41.57324063,52.5090
      5664,41.35631993,46.62230242,39.01578865
 135  scen93,41.9288606,29.865941,24.6397751,1.655295195,4.166729192,12.82280951,32.15370785,34.85715727,34.59229151,8.286359123,13.57407041,14.29290826,11.36655367,16.95207085,8.490441812,30.49374289,30.17663911,15.55720806,33.18937466,28.25286464,32.981
      40709,11.1596171,20.36955471,4.689799583
 136  scen94,50.4526188,46.491223,52.94050175,10.46641516,15.18354399,22.08477187,5.902171098,17.62728045,16.06091254,10.7097465,0.52959337,3.09166733,25.3978675,27.65963636,30.29008882,34.91375867,21.2073322,12.54373573,41.86514234,63.6026136,68.85765812
      ,29.05813327,29.03097359,13.94268273
 137  scen95,40.49355057,3.742719921,19.76568217,3.39584503,1.356086113,1.778507166,9.918585136,15.12798597,14.74551029,21.3003204,7.940489261,16.74588799,3.159292828,12.87461885,1.088690579,33.86016761,17.41222927,10.30861259,4.579722288,11.47446559,29.5
      4289623,11.5224943,0.864288309,1.06479772
 138  scen96,36.49905373,39.5596544,48.11231234,3.464121836,15.56052239,8.607438703,20.31202416,34.27446909,45.89598815,12.75969465,11.34076169,5.541406058,2.291678321,0.026194634,11.06820091,27.19714567,26.41224398,24.4305756,31.24459103,39.5413524,31.97
      020598,19.17704625,17.47765778,12.05658834
 139  scen97,30.7245658,40.91063545,49.26088696,6.035654831,6.311994183,4.559342992,16.1163631,21.28833829,35.01325901,27.34182781,48.86951745,57.03109661,1.399407564,4.675911763,7.329679764,20.9776149,35.02157908,39.57594151,28.86724579,8.344148452,0.897
      925971,15.77490256,18.76700747,33.62355962
 140  scen98,44.67792446,46.03862053,45.17748899,0.811797175,16.09778631,17.65828215,7.944983836,7.416239315,18.22624558,7.330042342,16.80505308,21.25173217,19.46157421,21.7443793,29.33144836,29.49759113,36.78488087,32.81971537,26.74528965,13.73473716,15.
      11157476,41.2886725,41.43510531,22.02226399
 141  scen99,18.71019612,11.74335343,13.81640476,1.154972458,3.925915817,18.53946458,8.173948406,26.53955805,25.46280407,0.794616587,3.995766409,9.847914733,3.074924828,18.0501795,20.77927314,54.88628927,68.26169645,71.955831,32.70187908,26.1034293,21.441
      56287,24.65162793,40.96619031,34.99515193
 142  scen100,27.58922683,38.34712605,46.5566615,5.025795363,14.03898583,11.92728321,2.588285916,4.53690546,16.00980719,3.709276282,20.12432785,23.97107096,15.78960768,10.80035921,23.9877134,24.46146699,40.31909377,48.30878889,36.49528453,34.13338646,27.6
      8358197,29.39911825,26.01896745,30.32221387
 144  ;
 145  *alias(solar,wind);
 146   
 147  *Tolerance
 148  scalar tol;
 149  *tol=%TOL%;
 150  tol=0.07;
 151   
 152  * maximum number of iterations in LR
 153  set iter number of subgradient iterations /iter1*iter10/;
 154   
 155  * time limit for each problem
 156  scalar time_limit;
 157  *time_limit=%TIMELIM%;
 158  time_limit=2250;
 159   
 160   
 161  * Import the SORTED file
 162  table scenario_sorted(scen,*)
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/scenario_sorted_100_13_05.csv
 164   ,value
****  $463
**** LINE      1 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/scenario_sorted_100_13_05.csv
**** LINE     43 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/inputME.gms
**** LINE     19 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 165  scen95,1
 166  scen70,1
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 167  scen85,1
 168  scen62,1
 169  scen42,1
 170  scen9,1
 171  scen22,1
 172  scen59,0
 173  scen8,0
 174  scen17,0
 175  scen72,0
 176  scen7,0
 177  scen6,0
 178  scen44,0
 179  scen25,0
 180  scen31,0
 181  scen24,0
 182  scen54,0
 183  scen82,0
 184  scen29,0
 185  scen10,0
 186  scen35,0
 187  scen60,0
 188  scen71,0
 189  scen32,0
 190  scen65,0
 191  scen66,0
 192  scen2,0
 193  scen58,0
 194  scen91,0
 195  scen57,0
 196  scen46,0
 197  scen63,0
 198  scen87,0
 199  scen99,0
 200  scen37,0
 201  scen93,0
 202  scen4,0
 203  scen13,0
 204  scen96,0
 205  scen77,0
 206  scen20,0
 207  scen23,0
 208  scen50,0
 209  scen47,0
 210  scen69,0
 211  scen16,0
 212  scen21,0
 213  scen55,0
 214  scen1,0
 215  scen27,0
 216  scen100,0
 217  scen64,0
 218  scen51,0
 219  scen73,0
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 220  scen83,0
 221  scen30,0
 222  scen18,0
 223  scen90,0
 224  scen75,0
 225  scen48,0
 226  scen56,0
 227  scen67,0
 228  scen98,0
 229  scen52,0
 230  scen12,0
 231  scen11,0
 232  scen53,0
 233  scen94,0
 234  scen26,0
 235  scen28,0
 236  scen14,0
 237  scen43,0
 238  scen79,0
 239  scen49,0
 240  scen39,0
 241  scen61,0
 242  scen86,0
 243  scen19,0
 244  scen74,0
 245  scen92,0
 246  scen40,0
 247  scen84,0
 248  scen88,0
 249  scen34,0
 250  scen36,0
 251  scen76,0
 252  scen3,0
 253  scen80,0
 254  scen45,0
 255  scen38,0
 256  scen33,0
 257  scen68,0
 258  scen41,0
 259  scen97,0
 260  scen15,0
 261  scen81,0
 262  scen78,0
 263  scen89,0
 264  scen5,0
 266  ;
 267   
 268   
 269   
 270   
 271  ALIAS (T,TT);
 272  alias(scen,i);
 273   
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 274  scalar n;
 275  n=card(scen);
 276   
 277  *Scalar which tells if LR converges
 278  scalar convergence;
 279   
 280  ** define battery  operation costs costs and solar selling prices
 281   
 282  TABLE PRICES(t,*)
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/wind_costs.csv
 285  ,REW,GEN
 286  t1,21.86631793,50
 287  t2,22.68762551,50
 288  t3,22.63231186,50
 289  t4,23.53977501,50
 290  t5,24.15305477,50
 291  t6,25.0022415,50
 292  t7,26.14884331,50
 293  t8,28.48265662,50
 294  t9,35.32421651,50
 295  t10,53.07988113,50
 296  t11,67.07745747,50
 297  t12,43.78264533,50
 298  t13,33.25218533,50
 299  t14,28.68827035,50
 300  t15,26.76175663,50
 301  t16,23.97472252,50
 302  t17,21.05077606,50
 303  t18,18.8721276,50
 304  t19,17.16537812,50
 305  t20,15.4798614,50
 306  t21,14.81514842,50
 307  t22,14.64047737,50
 308  t23,15.10197375,50
 309  t24,17.32390701,50
 311  ;
 312  *alias(costs, prices);
 313   
 314  Prices(t,'rew')     =  - Prices(t,'rew');
 315  Prices(t,'gen')    =  - Prices(t,'gen');
 316  ** define solar scenarios at all time periods
 317   
 318   
 319  * Scaling of wind power scenarios ;
 320  scalar scale ;
 321  scale = 1;
 322  wind(scen,t) = scale* wind(scen,t) ;
 323  * Remove too many decimals in Solar
 324  wind(scen,t) = round(wind(scen,t),2) ;
 325   
 326   
 327  scalar PROBABILITY;
 328  PROBABILITY = 1/CARD(scen);
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/22/21 16:46:26 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 329   
 330   
 331  parameters max_store(t), min_store(t), max_charge, max_discharge;
 332   
 333   
 334  ** define tolerance threshold
 335  SCALAR threshold;
 336  threshold = floor(card(scen)*TOL)  ;
 337   
      parameter BigX, LowX, X_0 maximum minimum initial energy stored ;
      parameter BigM(scen,t) find a good BigM ;
       
      BigX = 960 ;
      LowX = 0.2* BigX ;
      X_0  = 0.5* BigX ;
      max_charge =  0.5* BigX ;
      max_discharge =  0.5* BigX ;
 348   
 349  ************** Find a Big M
 350   
 351  * find Ntol + 1st value
 352  parameter maxwind(t), minwind(t), dummywind(w,t) ;
 353  maxwind(t) =smax(w,wind(w,t)) ;
 354  dummywind(w,t) = wind(w,t) ;
 355   
 356  scalar it ;
 357  it = floor(card(w)*tol) + 1;
 358   
 359  * index of it
 360  set dummy(w);
 361  * make the dum_iter go till at least the size of it
 362  set dum_iter /dum_iter1*dum_iter100/;
 363  loop(t,
 364  loop(dum_iter$(ord(dum_iter)le it),
 365  * find the smallest wind value for this t
 366           minwind(t) = smin(w,dummywind(w,t)) ;
 367  * index of smallest wind value
 368           dummy(w) = yes$(dummywind(w,t) eq minwind(t)) ;
 369  * make the smallest wind value large
 370           dummywind(w,t)$dummy(w) =maxwind(t) ;
 371  ); );
 372  display minwind ;
 373   
 374   
 375   
 376  parameter BigMM(w), BigM(w,t);
 377  BigMM(w)= smax(t, wind(w,t));
 378  BigM(w,t)= G - wind(w,t) + minwind(t);
 379   
 380   
 381  scalar run_time_total, start_time, end_time, LP_time, bound_time, lr_time ;
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/subgradient_parameters.gms
 383  parameter lambda;
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 384  parameter ldual value of Lagrangian dual ;
 385  parameter bound total value of Lagrangian dual ;
 386  scalar init_lambda, init_bound initial value of lambda dual LP objective from LP ;
 387  *Hier werden die maximalen Iterationen, also big M festgelegt
 388  *set iter                 number of subgradient iterations /iter1*iter3/;
 389  scalar num_iter          how many iterations we did ;
 390  scalar contin            stopping             /1/;
 391  parameter stepsize;
 392  scalar theta /2/;
 393  scalar originalTheta;
 394  originalTheta=theta;
 395  scalar noimprovement /0/;
 396  scalar upperbound ;
 397  parameter gamma           subgradient          ;
 398  parameter b;
 399  parameter norm;
 400  parameter norm2;
 401  scalar lowerbound;
 402  parameter lambdaprevious, deltalambda, results(iter,*), prev_w(scen,t), prev_y(t)  ;
 403   
 404   
 405  scalar m ;
 406  parameter   y_previous(scen,t), y_average_previous(t), weight_previous(scen,t);
 407  scalar profit_orig, t1, t2, exit_tol;
 408   
 409  scalar final_gap ;
 410   
 411  parameter lb(scen) ;
 412  parameter rho(t) ;
 413   
 414  scalar exit_tol ;
 415  exit_tol = 0.00001 ;
 416   
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/equations_all.gms
 418  POSITIVE VARIABLES X(W,T), Y(T);
 419  VARIABLES OBJ, BOUND_LR;
 420  BINARY VARIABLE Z(SCEN), R(W,T), U(W,T), V(W,T) ;
 421   
 422  scalar counter ;
 423   
 424  EQUATIONS
 425          Objective
 426          Const1_1(scen,t)
 427          Const1_2
 428          Const1_2_new
 429          Const_3_1(scen,t)
 430          Const_3_1_scenario(scen,t)
 431          Const_3_2(scen,t)
 432          Const_3_2_scenario(scen,t)
 433          Const_4_1(scen,t)
 434          Const_4_1_scenario(scen,t)
 435          Const_4_2(scen,t)
 436          Const_4_2_scenario(scen,t)
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 437          Const_5(scen,t)
 438          Const_5_scenario(scen,t)
 439          Const_6(scen,t)
 440          Const_6_scenario(scen,t)
 441          LR
 442          Objective_scenario(scen)
 443          Const1_1_scenario(scen,t)
 444          ;
 445   
 446  Objective.. OBJ=E= SUM(T,PRICES(T, 'REW')*Y(T) - PROBABILITY*SUM(scen, PRICES(T, 'GEN')*( X(scen,T) + GG*R(scen,t) ) )  )  ;
 447   
 448  LR.. bound_lr =e=   SUM(T,PRICES(T, 'REW')*Y(T) - PROBABILITY*SUM(scen, PRICES(T, 'GEN')*( X(scen,T) + GG*R(scen,t) ) )  )
 449                           - lambda* (threshold - sum(scen, z(scen)))  ;
 450   
 451  Objective_scenario(scen)$(ord(scen) eq counter)..
 452           OBJ =E= SUM(TT,PRICES(tt, 'REW')*Y(TT) - PRICES(TT, 'GEN')*( X(scen,TT) + GG*R(scen,tt) ) )     ;
 453   
 454  *Const1_1(W,T).. Y(T)-X(W,T)-R(W,T)*GG -Z(W)*WIND(W,T) =L= (1-Z(W))*BigMM(w) ;
 455  Const1_1(scen,T).. Y(T)-X(scen,T)-R(scen,T)*GG -WIND(scen,T) =L= Z(scen)*BigM(scen,t) ;
 456   
 457  *Const1_1_scenario(scen,t)$(ord(t) lt card(t) and (ord(scen) eq counter))..
 458  Const1_1_scenario(scen,t)$(ord(scen) eq counter)..
 459   
 460           Y(T)-X(scen,T)-R(scen,T)*GG -WIND(scen,T) =L= 0 ;
 461   
 462  Const1_2..   -SUM(SCEN, Z(SCEN)) =G= -threshold;
 463  Const1_2_new.. SUM(SCEN, Z(SCEN)) =L= threshold;
 464   
 465  ****************************************************************************TODO Constraints (all but no. 1) in scenario form (z(w)=0)
 466   
 467  * The generator constraints
 468   
 469  *Ramp
 470   
 471  Const_3_1(scen,T)$( ord(t) le (card(t)-1)).. X(scen,T+1) + GG*R(scen,t+1)- X(scen,T) - GG*R(scen,t)  =L= ramp*(U(scen,t+1) + R(scen,t)) ;
 472  Const_3_1_scenario(scen,T)$( ord(t) le (card(t)-1) and (ord(scen) eq counter)).. X(scen,T+1) + GG*R(scen,t+1)- X(scen,T) - GG*R(scen,t)  =L= ramp*(U(scen,t+1) + R(scen,t)) ;
 473   
 474  Const_3_2(scen,T)$( ord(t) le (card(t)-1)).. X(scen,T) + GG*R(scen,t)- X(scen,T+1) -GG*R(scen,t+1)=L= ramp*(V(scen,t+1) + R(scen,t+1)) ;
 475  Const_3_2_scenario(scen,T)$( ord(t) le (card(t)-1) and (ord(scen) eq counter)).. X(scen,T) + GG*R(scen,t)- X(scen,T+1) -GG*R(scen,t+1)=L= ramp*(V(scen,t+1) + R(scen,t+1)) ;
 476   
 477  *On/off
 478   
 479  Const_4_1(scen,T)$(ord(t) ge uptime)..   Sum(tt$((ORD(TT) le ORD(T)) and (ORD(TT) ge (ORD(T) - UPTIME +1))),U(scen,TT)) =L= R(scen,T) ;
 480  Const_4_1_scenario(scen,T)$(ord(t) ge uptime and (ord(scen) eq counter))..   Sum(tt$((ORD(TT) le ORD(T)) and (ORD(TT) ge (ORD(T) - UPTIME +1))),U(scen,TT)) =L= R(scen,T) ;
 481   
 482  Const_4_2(scen,T)$(ord(t) ge downtime )..Sum(tt$((ORD(TT) le ORD(T)) and (ORD(TT) ge (ORD(T) - DOWNTIME +1))),V(scen,TT)) =L= 1-R(scen,T) ;
 483  Const_4_2_scenario(scen,T)$(ord(t) ge downtime and (ord(scen) eq counter))..Sum(tt$((ORD(TT) le ORD(T)) and (ORD(TT) ge (ORD(T) - DOWNTIME +1))),V(scen,TT)) =L= 1-R(scen,T) ;
 484   
 485  Const_5(scen,T)$(ord(t) ge 2).. U(scen,T) - V(scen,T) =E= R(scen,T) - R(scen,T-1) ;
 486  Const_5_scenario(scen,T)$(ord(t) ge 2 and (ord(scen) eq counter)).. U(scen,T) - V(scen,T) =E= R(scen,T) - R(scen,T-1) ;
 487   
 488  *if uptime more than 1
 489  Const_6(scen,T)$( ord(t) le (card(t)-1))..   (G-GG)*R(scen,T)- (G-ramp)*U(scen,T) - (G-ramp)*V(scen,T+1) =G= X(scen,T);
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 12
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 490  Const_6_scenario(scen,T)$( ord(t) le (card(t)-1) and (ord(scen) eq counter))..   (G-GG)*R(scen,T)- (G-ramp)*U(scen,T) - (G-ramp)*V(scen,T+1) =G= X(scen,T);
 491   
 492   
 493  *** bounds on any variables
 494  X.UP(scen,T) =  G-GG;
 495  U.UP(scen,T) = 1;
 496  V.UP(scen,T) =1;
 497  Z.UP(scen)=1;
 498   
 499  * initialize the on/off variables
 500  * assume the unit was on for last (uptime -1) periods
 501  r.fx(scen,t)$(ord(t) eq 1) =1;
 502  u.fx(scen,t)$(ord(t) eq 1) = 0;
 503  v.fx(scen,t)$(ord(t) eq 1) = 0 ;
 504  * assume the generator was producing minimim power in last time period
 505  x.up(scen,t)$(ord(t) eq 1)= ramp - GG;
 506   
 507   
 508  ******* ALL MODELS
 509   
 510  model schedule     / Objective,  Const1_1, Const1_2, Const_3_1, Const_3_2, Const_4_1, Const_4_2, Const_5, Const_6 /;
 511  model schedule_scenario     / Objective_scenario,  Const1_1_scenario, Const_3_1_scenario, Const_3_2_scenario, Const_4_1_scenario, Const_4_2_scenario, Const_5_scenario, Const_6_scenario / ;
 512  *model INITIAL               / / ;
 513  model Lagrangian      / LR,    Const1_1, Const_3_1, Const_3_2, Const_4_1, Const_4_2, Const_5, Const_6 /;
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/lp_lowerbound.gms
 515  start_time = jnow ;
 516  options optca=0 ;
 517  options optcr=0 ;
 518  solve schedule using RMIP minimizing OBJ ;
****                                           $257
**** LINE      4 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/lp_lowerbound.gms
**** LINE     23 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 519  end_time =jnow ;
 520  LP_time = ghour(end_time - start_time)*3600 + gminute(end_time - start_time)*60 + gsecond(end_time - start_time);
 521  init_lambda  = Const1_2.m ;
****                          $141
**** LINE      7 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/lp_lowerbound.gms
**** LINE     23 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 522  lowerbound   = Obj.l ;
****                     $141
**** LINE      8 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/lp_lowerbound.gms
**** LINE     23 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 523  scalar LP_bound ;
 524  lambda       = init_lambda ;
 525  display init_lambda, LP_time, lowerbound    ;
 526  LP_bound   = Obj.l ;
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/heuristic_upperbound.gms
 528  ********************************************************************************
 529  * Find a upperbound on the problem : a feasible solution
 530  ********************************************************************************
 531   
 532  *upperbound =  0;
 533  * Find a upper bound using a fixed value and solving MIP (a feasible solution)
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 13
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 534  * solve single scenario problem and choose the worst #threshold problems
 535  start_time = jnow ;
 536  schedule_scenario.solvelink = 5 ;
 537  alias(rs,scen)
 538  parameter res_scenarios(rs,*) ;
 539   
 540  loop(rs,
 541  counter = ord(rs)  ;
 542  *Solving (2) for each scenario w with corresponding z(w) = 0
 543  solve schedule_scenario using MIP minimizing Obj ;
****                                                   $257
**** LINE     16 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/heuristic_upperbound.gms
**** LINE     24 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 544  res_scenarios(rs,'obj') =obj.l ;
 545   
 546   
 547  res_scenarios(rs,'scenario') = counter ;
 548  *=counter
 549   
 550   
 551  );
 552  end_time =jnow ;
 553  run_time_total = ghour(end_time - start_time)*3600 + gminute(end_time - start_time)*60 + gsecond(end_time - start_time);
 554   
 555   
 556  ** Write to a file to sort
 557  FILE scen_sorted /scen_sorted.csv/;
 558  *.PC specifies the format of the put file: 5 -> Formatted output; non-numeric output is quoted and each item is delimited with commas.
 559  scen_sorted.PC = 5;
 560  *.ND sets the number of decimals that are displayed in the put file
 561  scen_sorted.ND = 3;
 562  PUT scen_sorted;
 563  loop(rs, put res_scenarios(rs,'scenario') put res_scenarios(rs,'obj') put /; ) ;
 564  PUTCLOSE scen_sorted;
 565   
 566   
 567  z.lo(scen) = scenario_sorted(scen,'value') ;
****                                          $116
**** LINE     40 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/heuristic_upperbound.gms
**** LINE     24 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 568  *** Ensure file was generated correctly
 569  if ( sum(scen,z.lo(scen)) ne threshold, abort "sorted file not generated correctly check manually") ;
 570  start_time = jnow ;
 571  schedule.solprint = 0;
 572  *schedule.optfile  = 1;
 573  schedule.solvelink = 5 ;
 574  solve schedule using MIP minimizing Obj ;
****                                          $257
**** LINE     47 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/heuristic_upperbound.gms
**** LINE     24 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 575  end_time = jnow ;
 576  bound_time =  run_time_total + ghour(end_time - start_time)*3600 + gminute(end_time - start_time)*60 + gsecond(end_time - start_time);
 577  upperbound = Obj.l ;
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 14
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 578  prev_y(t) = y.l(t) ;
****                $141
**** LINE     51 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/heuristic_upperbound.gms
**** LINE     24 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 579  *prev_w(scen,t) = w.l(scen,t) ;
 580  * Clear bound on z now
 581  z.up(scen) = 1 ;
 582  z.lo(scen) = 0 ;
 583   
 584  display lowerbound,upperbound,prev_y, LP_time, bound_time  ;
 585   
 586   
 587   
 588  scalar d;
 589  *set indices /1/;
 590  set indices /1*6/;
 591   
 592  File TestingFile3 / TestingFile3.csv /;
 593  TestingFile3.pc=5;
 594  TestingFile3.nd=5;
 595  put TestingFile3;
 596  put 'Omega', put 'Tolerance', put 'Step Size Rule', put 'Iterations', put 'Converged?', put 'Gap LR', put 'Gap Naive', put 'Obj. Naive', put 'Obj. LR', put 'Gap' put 'Time Naive', put 'Time LR', put 'Final Lambda', put 'LB Heuristic' put /;
 597   
 598  ********************************************************************************
 599  * Solve main Problem
 600  ********************************************************************************
 601  option limrow = 10000;
 602  schedule.optfile=1;
 603   
 604   
 605  * When setting the start value of the one of the heuristic so the Naive model value will be greater or equal than the heuristic:
 606  * parameter heu_z(scen);
 607  * heu_z(scen)=z.l(scen);
 608  * z.l(scen)=heu_z(scen);
 609  start_time = jnow;
 610  solve schedule using MIP minimizing Obj ;
****                                          $257
**** LINE     49 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 611  end_time = jnow ;
 612   
 613   
 614   
 615  run_time_total = ghour(end_time - start_time)*3600 + gminute(end_time - start_time)*60 + gsecond(end_time - start_time);
 616   
 617  scalar ObjNaive;
 618  ObjNaive=Obj.l;
 619   
 620  scalar zlower;
 621  zlower=-Obj.l;
 622   
 623  scalar zupper;
 624  zupper=-schedule.objEst;
 625   
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 15
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 626  scalar GapNaive;
 627  GapNaive = (zupper-zlower)/zupper;
 628   
 629  scalar ObjLR;
 630   
 631  scalar heuristic;
 632   
 633  scalar TimeNaive;
 634  TimeNaive=run_time_total;
 635   
 636  display Obj.l, run_time_total ;
 637   
 638  ********************************************************************************
 639  * Solve the Lagrangian Dual problem now
 640  ********************************************************************************
 641   
 642   
 643  parameter ldual_iter(iter) obj function at each iteration ;
 644  lr_time = 0 ;
 645   
 646  option limrow = 0, limcol = 0, optca=0.0001, optcr=0.0001, RESLIM   = 2100;
 647   
 648  prev_y(t) = y.l(t) ;
 649   
 650  parameter check(scen,t);
 651  scalar steprule;
 652  scalar FinalIter;
 653   
 654  loop(indices,
 655      option clear=results;
 656      noimprovement = 0;
 657      lambda=init_lambda;
 658      lowerbound=LP_bound;
 659      theta=originalTheta;
 660      lr_time=0;
 661      run_time_total=0;
 662      contin=1;
 663      steprule=ord(indices);
 664   
 665      loop(iter$contin,
 666      num_iter = ord(iter) ;
 667  *         pass a warm start
 668               y.l(t) = prev_y(t) ;
 669               z.l(scen) = scenario_sorted(scen,'value') ;
 670               start_time = jnow;
 671   
 672  *********************************************************************
 673  ***Solve a Lagrangian iteration
 674  *********************************************************************
 675   
 676  *Test
 677   
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/plain_lr.gms
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 16
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 679  * Plain LR solve
 680  Lagrangian.solvelink = 5;
 681  Lagrangian.optfile   = 1;
 682  solve Lagrangian using mip minimizing bound_lr  ;
****                                                  $257
**** LINE      4 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/plain_lr.gms
**** LINE    117 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 683   
 684  bound             = bound_lr.l ;
****                               $141
**** LINE      6 INCLUDE     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/plain_lr.gms
**** LINE    117 INPUT       /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
 685  prev_y(t)         = y.l(t) ;
 686  last_z(scen)      = z.l(scen) ;
 687   
 688  * if model is unbounded
 689  if (Lagrangian.modelstat =18,  bound = -100000000;  );
 690  results(iter,'status') = Lagrangian.modelstat;
 691   
 692      end_time = jnow ;
 693      results(iter,'time') = ghour(end_time - start_time)*3600 + gminute(end_time - start_time)*60 + gsecond(end_time - start_time);
 694      results(iter,'objective') = bound ;
 695   
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/LR_updates.gms
 697  *** UPDATES FOR LAMBDA, GAMMA, THETA
 698   
 699  * Gamma update
 700  gamma =  threshold - sum(scen, last_z(scen));
 701   
 702  * Bound and theta Update -> in stepsize 6
 703  if (bound > lowerbound,
 704           lowerbound = bound;
 705           noimprovement = 0;
 706  else
 707           noimprovement = noimprovement + 1;
 708           if (noimprovement > 1,  theta = theta/2; noimprovement = 0; );
 709  );
 710   
 711  * Fix the Stepsize
 712   
INCLUDE    /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/stepsizes.gms
 714  *** Guarantees that never zero in the denominator
 715  *norm = max(abs(gamma), 1e-6);
 716  norm2 = max(gamma*gamma, 1e-6);
 717   
 718  *** constant step-size rule
 719  if(steprule=1,stepsize =0.58;);
 720   
 721  *** constant step length
 722  if(steprule=2,stepsize = 200/norm2;);
 723   
 724  *** square summable but not summable
 725  if(steprule=3,stepsize =3/(2+num_iter););
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 17
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 726   
 727  *** nonsummable diminishing
 728  if(steprule=4,stepsize= 1/sqrt(num_iter););
 729   
 730  *** nonsummable diminishing step length
 731  if(steprule=5,stepsize= (300/num_iter)/norm2;);
 732   
 733  *** original
 734  if(steprule=6,stepsize=theta*(upperbound - bound)/norm2;);
 735   
 736  * Lambda Update
 737   
 738  lambdaprevious = lambda ;
 739   
 740           if (gamma ge 0 and lambdaprevious eq 0,
 741                   lambda = lambdaprevious ; );
 742           if (gamma gt 0 and lambdaprevious gt 0,
 743                   lambda = lambdaprevious - min(stepsize, lambdaprevious/gamma)*gamma ; );
 744           if (gamma le 0,
 745                   lambda = lambdaprevious - stepsize*gamma; );
 746   
 747  * Check convergence
 748  convergence=0;
 749  deltalambda = abs(lambdaprevious-lambda) ;
 750  if( deltalambda < 0.0001, contin = 0; display 'lambdas same'; convergence = 1 );
 751   
 752  * Results output
 753  results(iter,'deltalambda') = deltalambda;
 754  results(iter,'noimprov') = noimprovement;
 755  results(iter,'theta') = theta;
 756  results(iter,'step') = stepsize;
 757  results(iter,'gamma') = gamma ;
 758  results(iter,'lambda') = lambda ;
 759  results(iter,'gap') = (((-lowerbound)+upperbound)/(-lowerbound))    ; //gap is same as computed by GAMS
 760      if( ((results(iter,'gap') < exit_tol) and (num_iter > 2)),convergence=2; contin = 0;);
 761      lr_time = lr_time + results(iter,'time')   ;
 762      if (lr_time > 2400, contin = 0 ; ) ;
 763   
 764      d=results(iter,'gap');
 765      FinalIter=num_iter;
 766  );
 767   
 768  run_time_total = LP_time + lr_time + bound_time  ;
 769   
 770  * check if any p and q active simultaneously (nothing to do with Lagrangian)
 771  *parameter check(scen,t);
 772   
 773   
 774  ObjLR=-lowerbound;
 775  heuristic=-upperbound;
 776   
 777  put TestingFile3;
 778  put n, put tol, put steprule, put FinalIter, put convergence, put d, put GapNaive, put zlower, put ObjLR, put ((ObjLR-max(heuristic,zlower))/ObjLR), put TimeNaive, put lr_time, put lambda, put heuristic put /;
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 18
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 779   
 780  display results, lowerbound, upperbound, LP_bound, run_time_total, lr_time, num_iter ;
 781  display z.l, y.l ;
 782  display zlower, zupper, ObjLR, heuristic;
 783   
 784  );
 785   

**** LIST OF STRAY NAMES - CHECK DECLARATIONS FOR SPURIOUS COMMAS
**** STRAY NAME start_cost OF TYPE PARAM
**** STRAY NAME max_charge OF TYPE PARAM
**** STRAY NAME max_discharge OF TYPE PARAM
**** STRAY NAME init_bound OF TYPE PARAM
**** STRAY NAME t1 OF TYPE PARAM
**** STRAY NAME t2 OF TYPE PARAM
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 19
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


116  Label is unknown
141  Symbol declared but no values have been assigned. Check for missing
        data definition, assignment, data loading or implicit assignment
        via a solve statement.
        A wild shot: You may have spurious commas in the explanatory
        text of a declaration. Check symbol reference list.
257  Solve statement not checked because of previous errors
463  The column section in the previous table is missing

**** 11 ERROR(S)   0 WARNING(S)
GAMS 24.8.5  r61358 Released May 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/22/21 16:46:26 Page 20
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
     2       19 INCLUDE        1      19  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/inputME.gms
     3       41 INCLUDE        2      22  ../home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/wind_scenarios_100_13.csv
     4      163 INCLUDE        2      43  ../home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/scenario_sorted_100_13_05.csv
     5      284 INCLUDE        2      63  ../home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/wind_costs.csv
     6      382 INCLUDE        1      20  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/subgradient_parameters.gms
     7      417 INCLUDE        1      22  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/equations_all.gms
     8      514 INCLUDE        1      23  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/lp_lowerbound.gms
     9      527 INCLUDE        1      24  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/heuristic_upperbound.gms
    10      678 INCLUDE        1     117  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/plain_lr.gms
    11      696 INCLUDE        1     123  ./home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/LR_updates.gms
    12      713 INCLUDE       11      17  ../home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/stepsizes.gms


COMPILATION TIME     =        3.454 SECONDS      3 MB  24.8.5 r61358 LEX-LEG


USER: Small MUD - 5 User License                     S160825:0507AO-LNX
      Universitaet Erlangen-Nuernberg, Lehrstuhl f. WirtschaftsmaDC7699
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.gms
Output     /home/hpc/mpwm/mpwm031h/ArticleSubgradient/Code/SampleRun_Environment/100Scens/tol07/Scenario13/Naive_LR_solving.lst

**** USER ERROR(S) ENCOUNTERED
